import{T as L}from"./index-F4zUvqIc.js";import{d as F,a as N}from"./hotel-DdejCOdd.js";import{u as B,a as P}from"./role-bFoOqc15.js";import{d as T,L as U,k as h,_ as q,y as V,o as v,w as t,b as a,r as n,i as C,N as E,E as G,u as z,c as J,a as _,e as D,t as $,J as O,K as j,M as A}from"./index-BrpxYkzO.js";import{s as M,a as R,b as I}from"./Search-hOF0ZlMh.js";const K=T({components:{Layer:U},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,l){const m=h(null),f=h(null);let p=h({id:"",url:"",name:"",price:"",content:""});const g={id:[{required:!0,message:"请输入主键",trigger:"blur"}],url:[{required:!0,message:"请输入封面",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"}],content:[{required:!0,message:"请输入详情内容",trigger:"blur"}]};s();function s(){e.layer.row&&(p.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:p,rules:g,layerDom:f,ruleForm:m}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let l=this.form;this.layer.row?this.updateForm(l):this.addForm(l)}else return!1})},addForm(e){P(e).then(l=>{this.$message({type:"success",message:"新增成功"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){B(e.id,e).then(l=>{this.$message({type:"success",message:"编辑成功"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function H(e,l,m,f,p,g){const s=n("el-input"),d=n("el-form-item"),u=n("el-form"),b=n("Layer",!0);return v(),V(b,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:t(()=>[a(u,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:t(()=>[a(d,{label:"封面：",prop:"url"},{default:t(()=>[a(s,{modelValue:e.form.url,"onUpdate:modelValue":l[0]||(l[0]=i=>e.form.url=i),placeholder:"请输入封面"},null,8,["modelValue"])]),_:1}),a(d,{label:"名称：",prop:"name"},{default:t(()=>[a(s,{modelValue:e.form.name,"onUpdate:modelValue":l[1]||(l[1]=i=>e.form.name=i),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),a(d,{label:"价格：",prop:"price"},{default:t(()=>[a(s,{modelValue:e.form.price,"onUpdate:modelValue":l[2]||(l[2]=i=>e.form.price=i),placeholder:"请输入价格"},null,8,["modelValue"])]),_:1}),a(d,{label:"详情内容：",prop:"content"},{default:t(()=>[a(s,{modelValue:e.form.content,"onUpdate:modelValue":l[3]||(l[3]=i=>e.form.content=i),placeholder:"请输入详情内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}const Q=q(K,[["render",H]]),W=T({name:"crudTable",components:{Table:L,Layer:Q},setup(){const e=C({}),l=C({show:!1,title:"新增",showButton:!0}),m=C({currentPage:1,pageSize:10,totalCount:0}),f=h(!0),p=h([]),g=h([]),s=z(),d=o=>{g.value=o},u=o=>{f.value=!0,o&&(m.currentPage=1);let y={currentPage:m.currentPage,pageSize:m.pageSize,...e};F(y).then(c=>{p.value=c.data.list,m.totalCount=Number(c.data.totalCount)}).catch(c=>{p.value=[],m.currentPage=1,m.totalCount=0}).finally(()=>{f.value=!1})},b=o=>{let y={ids:o.map(c=>c.id).join(",")};N(y.ids).then(c=>{G({type:"success",message:"删除成功"}),u(p.value.length===1)})},i=()=>{s.push({path:"/hotel/add"})},w=o=>{s.push({path:"/hotel/update",query:{id:o.id}})};return u(!0),{Plus:I,Search:R,Delete:M,query:e,tableData:p,chooseData:g,loading:f,page:m,layer:l,handleSelectionChange:d,handleAdd:i,handleEdit:w,handleDel:b,getTableData:u,handleTime:E}}}),X={class:"layout-container"},Y={class:"layout-container-form flex space-between"},Z={class:"layout-container-form-search"},x={class:"layout-container-form flex space-between"},ee={class:"layout-container-form-handle"},ae={class:"layout-container-table"};function le(e,l,m,f,p,g){const s=n("el-input"),d=n("el-form-item"),u=n("el-button"),b=n("el-form"),i=n("el-popconfirm"),w=n("el-image"),o=n("el-table-column"),y=n("Table"),c=n("Layer"),k=A("loading");return v(),J("div",X,[_("div",Y,[_("div",Z,[a(b,{inline:!0,model:e.params,class:"demo-form-inline"},{default:t(()=>[a(d,{label:"酒店名称："},{default:t(()=>[a(s,{modelValue:e.query.qp_name_like,"onUpdate:modelValue":l[0]||(l[0]=r=>e.query.qp_name_like=r),placeholder:"请输入酒店名称",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{label:"价格："},{default:t(()=>[a(s,{modelValue:e.query.qp_price_like,"onUpdate:modelValue":l[1]||(l[1]=r=>e.query.qp_price_like=r),placeholder:"请输入价格",clearable:""},null,8,["modelValue"])]),_:1}),a(d,null,{default:t(()=>[a(u,{type:"primary",onClick:l[2]||(l[2]=r=>e.getTableData())},{default:t(()=>[...l[5]||(l[5]=[D("查询",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_("div",x,[_("div",ee,[a(u,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:t(()=>[D($(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),a(i,{title:e.$t("message.common.delTip"),onConfirm:l[3]||(l[3]=r=>e.handleDel(e.chooseData))},{reference:t(()=>[a(u,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:t(()=>[D($(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])])]),_("div",ae,[O((v(),V(y,{ref:"table",page:e.page,"onUpdate:page":l[4]||(l[4]=r=>e.page=r),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:t(()=>[a(o,{prop:"url",label:"封面",align:"center"},{default:t(r=>[a(w,{style:{width:"100px",height:"100px"},src:r.row.url,"preview-src-list":[r.row.url],"initial-index":0,fit:"url","append-to-body":!0},null,8,["src","preview-src-list"])]),_:1}),a(o,{prop:"name",label:"名称",align:"center"}),a(o,{prop:"price",label:"价格",align:"center"}),a(o,{prop:"inventory",label:"库存",align:"center"}),a(o,{prop:"shortRecommend",label:"简要介绍",align:"center"}),a(o,{prop:"address",label:"地址",align:"center"}),a(o,{prop:"createTime",label:"创建时间",align:"center",formatter:e.handleTime},null,8,["formatter"]),a(o,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:t(r=>[a(u,{onClick:S=>e.handleEdit(r.row)},{default:t(()=>[D($(e.$t("message.common.update")),1)]),_:1},8,["onClick"]),a(i,{title:e.$t("message.common.delTip"),onConfirm:S=>e.handleDel([r.row])},{reference:t(()=>[a(u,{type:"danger"},{default:t(()=>[D($(e.$t("message.common.del")),1)]),_:1})]),_:1},8,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[k,e.loading]]),e.layer.show?(v(),V(c,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):j("",!0)])])}const ie=q(W,[["render",le]]);export{ie as default};

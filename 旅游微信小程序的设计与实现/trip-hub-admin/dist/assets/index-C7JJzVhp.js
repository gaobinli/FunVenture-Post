import{T as U}from"./index-F4zUvqIc.js";import{d as L,a as F}from"./scenicSpot-CbD-Hf2l.js";import{u as N,a as B}from"./role-bFoOqc15.js";import{d as T,L as P,k as b,_ as S,y as C,o as $,w as o,b as l,r as s,i as V,N as R,E,u as G,c as z,a as w,e as D,t as _,J,K as O,M as j}from"./index-BrpxYkzO.js";import{s as A,a as M,b as I}from"./Search-hOF0ZlMh.js";const K=T({components:{Layer:P},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const i=b(null),g=b(null);let c=b({id:"",name:"",url:"",address:"",introduce:"",price:"",cover_url:"",shortRecommend:""});const h={id:[{required:!0,message:"请输入主键",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],url:[{required:!0,message:"请输入景点导航图",trigger:"blur"}],address:[{required:!0,message:"请输入景点地址",trigger:"blur"}],introduce:[{required:!0,message:"请输入景点介绍",trigger:"blur"}],price:[{required:!0,message:"请输入门票价格",trigger:"blur"}],shortRecommend:[{required:!0,message:"请输入简单推荐",trigger:"blur"}]};n();function n(){e.layer.row&&(c.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:c,rules:h,layerDom:g,ruleForm:i}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){B(e).then(a=>{this.$message({type:"success",message:"新增成功"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){N(e.id,e).then(a=>{this.$message({type:"success",message:"编辑成功"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function H(e,a,i,g,c,h){const n=s("el-input"),d=s("el-form-item"),m=s("el-form"),y=s("Layer",!0);return $(),C(y,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:o(()=>[l(m,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:o(()=>[l(d,{label:"名称：",prop:"name"},{default:o(()=>[l(n,{modelValue:e.form.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.form.name=t),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"景点导航图：",prop:"url"},{default:o(()=>[l(n,{modelValue:e.form.url,"onUpdate:modelValue":a[1]||(a[1]=t=>e.form.url=t),placeholder:"请输入景点导航图"},null,8,["modelValue"])]),_:1}),l(d,{label:"景点地址：",prop:"address"},{default:o(()=>[l(n,{modelValue:e.form.address,"onUpdate:modelValue":a[2]||(a[2]=t=>e.form.address=t),placeholder:"请输入景点地址"},null,8,["modelValue"])]),_:1}),l(d,{label:"景点介绍：",prop:"introduce"},{default:o(()=>[l(n,{modelValue:e.form.introduce,"onUpdate:modelValue":a[3]||(a[3]=t=>e.form.introduce=t),placeholder:"请输入景点介绍"},null,8,["modelValue"])]),_:1}),l(d,{label:"门票价格：",prop:"price"},{default:o(()=>[l(n,{modelValue:e.form.price,"onUpdate:modelValue":a[4]||(a[4]=t=>e.form.price=t),placeholder:"请输入门票价格"},null,8,["modelValue"])]),_:1}),l(d,{label:"简单推荐：",prop:"shortRecommend"},{default:o(()=>[l(n,{modelValue:e.form.shortRecommend,"onUpdate:modelValue":a[5]||(a[5]=t=>e.form.shortRecommend=t),placeholder:"请输入简单推荐"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}const Q=S(K,[["render",H]]),W=T({name:"crudTable",components:{Table:U,Layer:Q},setup(){const e=V({}),a=V({show:!1,title:"新增",showButton:!0}),i=V({currentPage:1,pageSize:10,totalCount:0}),g=b(!0),c=b([]),h=b([]),n=G(),d=p=>{h.value=p},m=p=>{g.value=!0,p&&(i.currentPage=1);let v={currentPage:i.currentPage,pageSize:i.pageSize,...e};L(v).then(f=>{c.value=f.data.list,i.totalCount=Number(f.data.totalCount)}).catch(f=>{c.value=[],i.currentPage=1,i.totalCount=0}).finally(()=>{g.value=!1})},y=p=>{let v={ids:p.map(f=>f.id).join(",")};F(v.ids).then(f=>{E({type:"success",message:"删除成功"}),m(c.value.length===1)})},t=()=>{n.push({path:"/scenicSpot/add"})},u=p=>{n.push({path:"/scenicSpot/update",query:{id:p.id}})};return m(!0),{Plus:I,Search:M,Delete:A,query:e,tableData:c,chooseData:h,loading:g,page:i,layer:a,handleSelectionChange:d,handleAdd:t,handleEdit:u,handleDel:y,getTableData:m,handleTime:R}}}),X={class:"layout-container"},Y={class:"layout-container-form flex space-between"},Z={class:"layout-container-form-search"},x={class:"layout-container-form flex space-between"},ee={class:"layout-container-form-handle"},le={class:"layout-container-table"};function ae(e,a,i,g,c,h){const n=s("el-input"),d=s("el-form-item"),m=s("el-button"),y=s("el-form"),t=s("el-popconfirm"),u=s("el-table-column"),p=s("el-image"),v=s("Table"),f=s("Layer"),q=j("loading");return $(),z("div",X,[w("div",Y,[w("div",Z,[l(y,{inline:!0,model:e.params,class:"demo-form-inline"},{default:o(()=>[l(d,{label:"名称："},{default:o(()=>[l(n,{modelValue:e.query.qp_name_like,"onUpdate:modelValue":a[0]||(a[0]=r=>e.query.qp_name_like=r),placeholder:"请输入名称",clearable:""},null,8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(m,{type:"primary",onClick:a[1]||(a[1]=r=>e.getTableData())},{default:o(()=>[...a[4]||(a[4]=[D("查询",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),w("div",x,[w("div",ee,[l(m,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:o(()=>[D(_(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),l(t,{title:e.$t("message.common.delTip"),onConfirm:a[2]||(a[2]=r=>e.handleDel(e.chooseData))},{reference:o(()=>[l(m,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:o(()=>[D(_(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])])]),w("div",le,[J(($(),C(v,{ref:"table",page:e.page,"onUpdate:page":a[3]||(a[3]=r=>e.page=r),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:o(()=>[l(u,{prop:"name",label:"名称",align:"center"}),l(u,{prop:"coverUrl",label:"景点封面图",align:"center"},{default:o(r=>[l(p,{style:{width:"100px",height:"100px"},src:r.row.coverUrl,"preview-src-list":[r.row.coverUrl],"initial-index":0,fit:"coverUrl","append-to-body":!0},null,8,["src","preview-src-list"])]),_:1}),l(u,{prop:"url",label:"景点导航图",align:"center"},{default:o(r=>[l(p,{style:{width:"100px",height:"100px"},src:r.row.url,"preview-src-list":[r.row.url],"initial-index":0,fit:"url","append-to-body":!0},null,8,["src","preview-src-list"])]),_:1}),l(u,{prop:"address",label:"景点地址",align:"center"}),l(u,{prop:"price",label:"门票价格",align:"center"}),l(u,{prop:"inventory",label:"库存",align:"center"}),l(u,{prop:"shortRecommend",label:"简单介绍",align:"center"}),l(u,{prop:"createTime",label:"创建时间",align:"center",formatter:e.handleTime},null,8,["formatter"]),l(u,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:o(r=>[l(m,{onClick:k=>e.handleEdit(r.row)},{default:o(()=>[D(_(e.$t("message.common.update")),1)]),_:1},8,["onClick"]),l(t,{title:e.$t("message.common.delTip"),onConfirm:k=>e.handleDel([r.row])},{reference:o(()=>[l(m,{type:"danger"},{default:o(()=>[D(_(e.$t("message.common.del")),1)]),_:1})]),_:1},8,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[q,e.loading]]),e.layer.show?($(),C(f,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):O("",!0)])])}const ie=S(W,[["render",ae]]);export{ie as default};

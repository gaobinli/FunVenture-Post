{"version":3,"file":"index.js","sources":["../../../../../src/pages/index/index.vue","../../../../../uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { getHomeBannerAPI, getHomeCategoryAPI } from '@/services/home'\r\nimport CustomNavbar from './components/CustomNavbar.vue'\r\nimport CategoryPanel from './components/CategoryPanel.vue'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport type { BannerItem, CategoryItem } from '@/types/home'\r\nimport { ref } from 'vue'\r\nimport PageSkeleton from \"./components/PageSkeleton.vue\";\r\nimport { useCustomScenicSpotRecommendList } from '@/composables'\r\n\r\n// 获取屏幕边界到安全区域距离\r\nconst { safeAreaInsets } = uni.getSystemInfoSync()\r\n\r\n// 获取轮播图数据\r\nconst bannerList = ref<BannerItem[]>([])\r\nconst getHomeBannerData = async () => {\r\n  const res = await getHomeBannerAPI()\r\n  bannerList.value = res.data\r\n}\r\n\r\n// 获取前台分类数据\r\nconst categoryList = ref<CategoryItem[]>([])\r\nconst getHomeCategoryData = async () => {\r\n  const res = await getHomeCategoryAPI()\r\n  categoryList.value = res.data\r\n}\r\n\r\n// 是否加载中的标记\r\nconst isLoading = ref(false)\r\n// 页面数据加载\r\nonLoad(async () => {\r\n  isLoading.value = true\r\n  getHomeBannerData()\r\n  getHomeCategoryData()\r\n  await Promise.all([getHomeBannerData(), getHomeCategoryData(), scenicSpotRef.value?.getMore()])\r\n  isLoading.value = false\r\n})\r\n\r\n// 组合式函数调用\r\nconst { scenicSpotRef, onScrolltolower } = useCustomScenicSpotRecommendList()\r\n\r\n// 自定义下拉刷新被触发\r\nconst isTriggered = ref(false)\r\nconst onRefresherrefresh = async () => {\r\n  console.log(\"自定义下拉刷新触发\");\r\n  // 开始动画\r\n  isTriggered.value = true\r\n  // 加载数据（await 等待一个接口请求完才请求下一个，性能优化，直接三个接口一起，然后等待结束）\r\n  await getHomeBannerData()\r\n  await getHomeCategoryData()\r\n  // 重置组件数据\r\n  scenicSpotRef.value?.resetData()\r\n  await Promise.all([getHomeBannerData(), getHomeCategoryData(), scenicSpotRef.value?.getMore()])\r\n  // 关闭动画\r\n  isTriggered.value = false\r\n}\r\n\r\nconst search = async (inputSearchValue: string) => {\r\n  console.log(inputSearchValue.detail.value)\r\n  scenicSpotRef.value.searchValue = inputSearchValue.detail.value\r\n  scenicSpotRef.value?.resetData()\r\n  await Promise.all([scenicSpotRef.value?.getMore()])\r\n}\r\n</script>\r\n\r\n<template>\r\n  <!-- 自定义导航栏 -->\r\n  <!-- <CustomNavbar /> -->\r\n  <view class=\"navbar\" :style=\"{ paddingTop: safeAreaInsets!.top + 10 + 'px' }\">\r\n    <view class=\"logo\">\r\n      <text class=\"logo-title\">重庆旅游</text>\r\n      <text class=\"logo-text\">美丽 · 重庆 · 自然</text>\r\n    </view>\r\n    <!-- 搜索条 -->\r\n    <view class=\"search\">\r\n      <input class=\"uni-input\" focus placeholder=\"输入景点名称\" @input=\"search($event)\" />\r\n    </view>\r\n  </view>\r\n  <scroll-view refresher-enabled @refresherrefresh=\"onRefresherrefresh\" :refresher-triggered=\"isTriggered\"\r\n    @scrolltolower=\"onScrolltolower\" scroll-y>\r\n    <PageSkeleton v-if=\"isLoading\" />\r\n    <template v-else>\r\n      <CustomSwiper :list=\"bannerList\" />\r\n      <CategoryPanel :list=\"categoryList\" />\r\n      <CustomScenicSpotRecommend ref=\"scenicSpotRef\" />\r\n    </template>\r\n  </scroll-view>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\npage {\r\n  background-color: #f7f7f7;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.scroll-view {\r\n  flex: 1;\r\n}\r\n\r\n.navbar {\r\n  background-image: url(@/static/images/navigator_bg.png);\r\n  background-size: cover;\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding-top: 20px;\r\n  padding-bottom: 20px;\r\n\r\n  .logo {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 64rpx;\r\n    padding-left: 30rpx;\r\n\r\n    .logo-title {\r\n      line-height: 45rpx;\r\n      color: #fff;\r\n      margin: 2rpx 0 0 20rpx;\r\n      font-size: 45rpx;\r\n    }\r\n\r\n    .logo-text {\r\n      flex: 1;\r\n      line-height: 28rpx;\r\n      color: #fff;\r\n      margin: 2rpx 0 0 20rpx;\r\n      padding-left: 20rpx;\r\n      border-left: 1rpx solid #fff;\r\n      font-size: 26rpx;\r\n    }\r\n  }\r\n\r\n  .search {\r\n    // display: flex;\r\n    // align-items: center;\r\n    // justify-content: space-between;\r\n    padding: 0 10rpx 0 26rpx;\r\n    height: 64rpx;\r\n    // margin: 16rpx 20rpx;\r\n    margin-top: 16rpx;\r\n    margin-left: 20rpx;\r\n    margin-right: 20rpx;\r\n    color: #fff;\r\n    font-size: 28rpx;\r\n    border-radius: 32rpx;\r\n    background-color: rgba(255, 255, 255, 0.5);\r\n\r\n    .uni-input {\r\n      line-height: 64rpx;\r\n      height: 64rpx;\r\n    }\r\n  }\r\n\r\n  .icon-search {\r\n    &::before {\r\n      margin-right: 10rpx;\r\n    }\r\n\r\n  }\r\n\r\n  // .icon-scan {\r\n  //   font-size: 30rpx;\r\n  //   padding: 15rpx;\r\n  // }\r\n}\r\n</style>","import MiniProgramPage from 'D:/gp/2026016-重庆旅游微信小程序的设计与实现/trip-hub-mp/src/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","ref","getHomeBannerAPI","getHomeCategoryAPI","onLoad","useCustomScenicSpotRecommendList"],"mappings":";;;;;;;;;;;;;;;;;AAGA,MAAA,gBAA0B,MAAA;AAI1B,MAAA,eAAyB,MAAA;;;;AAIzB,UAAM,EAAE,eAAA,IAAmBA,cAAA,MAAI,kBAAkB;AAG3C,UAAA,aAAaC,kBAAkB,CAAA,CAAE;AACvC,UAAM,oBAAoB,YAAY;AAC9B,YAAA,MAAM,MAAMC,cAAAA;AAClB,iBAAW,QAAQ,IAAI;AAAA,IAAA;AAInB,UAAA,eAAeD,kBAAoB,CAAA,CAAE;AAC3C,UAAM,sBAAsB,YAAY;AAChC,YAAA,MAAM,MAAME,cAAAA;AAClB,mBAAa,QAAQ,IAAI;AAAA,IAAA;AAIrB,UAAA,YAAYF,kBAAI,KAAK;AAE3BG,kBAAAA,OAAO,YAAY;;AACjB,gBAAU,QAAQ;AACA;AACE;AACd,YAAA,QAAQ,IAAI,CAAC,qBAAqB,wBAAuB,mBAAc,UAAd,mBAAqB,SAAS,CAAC;AAC9F,gBAAU,QAAQ;AAAA,IAAA,CACnB;AAGD,UAAM,EAAE,eAAe,gBAAgB,IAAIC,kBAAiC,iCAAA;AAGtE,UAAA,cAAcJ,kBAAI,KAAK;AAC7B,UAAM,qBAAqB,YAAY;;AACrC,cAAQ,IAAI,WAAW;AAEvB,kBAAY,QAAQ;AAEpB,YAAM,kBAAkB;AACxB,YAAM,oBAAoB;AAE1B,0BAAc,UAAd,mBAAqB;AACf,YAAA,QAAQ,IAAI,CAAC,qBAAqB,wBAAuB,mBAAc,UAAd,mBAAqB,SAAS,CAAC;AAE9F,kBAAY,QAAQ;AAAA,IAAA;AAGhB,UAAA,SAAS,OAAO,qBAA6B;;AACzC,cAAA,IAAI,iBAAiB,OAAO,KAAK;AAC3B,oBAAA,MAAM,cAAc,iBAAiB,OAAO;AAC1D,0BAAc,UAAd,mBAAqB;AACrB,YAAM,QAAQ,IAAI,EAAC,mBAAc,UAAd,mBAAqB,SAAS,CAAC;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5DpD,GAAG,WAAW,eAAe;"}
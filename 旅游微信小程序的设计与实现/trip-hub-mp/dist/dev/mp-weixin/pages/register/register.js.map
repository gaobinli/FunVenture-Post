{"version":3,"file":"register.js","sources":["../../../../../src/pages/register/register.vue","../../../../../uniPage:/cGFnZXMvcmVnaXN0ZXIvcmVnaXN0ZXIudnVl"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { postMemberProfileAPI } from '@/services/profile'\r\nimport type { ProfileDetail } from '@/types/member'\r\nimport { reactive, ref } from 'vue'\r\nimport { useMemberStore } from '@/stores'\r\n\r\n// 获取屏幕边界到安全区域距离\r\nconst { safeAreaInsets } = uni.getSystemInfoSync()\r\n\r\nconst memberStore = useMemberStore()\r\n\r\nconst userInfo = reactive({\r\n  avatar: '',\r\n  phone: '',\r\n  nickName: '',\r\n  password: '',\r\n  sex: 1,\r\n  enable: 1,\r\n})\r\n// 获取个人信息\r\n// const profile = ref<ProfileDetail>({} as ProfileDetail)\r\n// const getMemberProfileData = async () => {\r\n// const res = await getMemberProfileAPI()\r\n// userInfo.value = res.data\r\n// }\r\n\r\nonLoad(() => {\r\n  // getMemberProfileData()\r\n})\r\n\r\n// 修改头像\r\nconst onAvatarChange = () => {\r\n  // 调用拍照/选择图片\r\n  uni.chooseMedia({\r\n    // 文件个数\r\n    count: 1,\r\n    // 文件类型\r\n    mediaType: ['image'],\r\n    success: (res) => {\r\n      // 本地路径\r\n      const { tempFilePath } = res.tempFiles[0]\r\n      // 文件上传\r\n      uni.uploadFile({\r\n        url: '/upload',\r\n        name: 'file',\r\n        filePath: tempFilePath,\r\n        success: (res) => {\r\n          if (res.statusCode === 200) {\r\n            const avatarUploadUrl = JSON.parse(res.data).data\r\n            userInfo.avatar = avatarUploadUrl\r\n            uni.showToast({ icon: 'success', title: '上传成功' })\r\n          } else {\r\n            uni.showToast({ icon: 'error', title: '出现错误' })\r\n          }\r\n        },\r\n      })\r\n    },\r\n  })\r\n}\r\n\r\n// 点击保存提交表单\r\nconst onSubmit = async () => {\r\n  if (!userInfo.phone) {\r\n    uni.showToast({ icon: 'error', title: '请填写手机号' })\r\n    return\r\n  }\r\n  if (userInfo.phone.length != 11 || !/^[1][3,4,5,7,8][0-9]{9}$/.test(userInfo.phone)) {\r\n    uni.showToast({\r\n      title: '手机号格式错误',\r\n      icon: 'error',\r\n    })\r\n    return\r\n  }\r\n  if (!userInfo.nickName) {\r\n    uni.showToast({ icon: 'error', title: '请填写姓名' })\r\n    return\r\n  }\r\n  if (!userInfo.password) {\r\n    uni.showToast({ icon: 'error', title: '请填写密码' })\r\n    return\r\n  }\r\n  if (!userInfo.sex) {\r\n    uni.showToast({ icon: 'error', title: '请选择性别' })\r\n    return\r\n  }\r\n  const res = await postMemberProfileAPI(userInfo)\r\n  uni.showToast({ icon: 'success', title: '注册成功' })\r\n  // 清理用户信息\r\n  setTimeout(() => {\r\n    uni.navigateTo({ url: '/pages/login/login' })\r\n  }, 600)\r\n}\r\n\r\n// 修改性别\r\nconst onSexChange: UniHelper.RadioGroupOnChange = (ev) => {\r\n  userInfo.sex = Number(ev.detail.value)\r\n}\r\n</script>\r\n\r\n<template>\r\n  <view class=\"viewport\">\r\n    <!-- 导航栏 -->\r\n    <view class=\"navbar\" :style=\"{ paddingTop: safeAreaInsets?.top + 'px' }\">\r\n      <navigator open-type=\"navigateBack\" class=\"back icon-left\" hover-class=\"none\"></navigator>\r\n      <view class=\"title\">注册信息</view>\r\n    </view>\r\n    <!-- 头像 -->\r\n\r\n    <!-- 表单 -->\r\n    <view class=\"form\">\r\n      <!-- 表单内容 -->\r\n      <view class=\"avatar\">\r\n        <view @tap=\"onAvatarChange\" class=\"avatar-content\">\r\n          <image v-if=\"userInfo.avatar\" class=\"image\" :src=\"userInfo.avatar\" mode=\"aspectFill\" />\r\n          <image v-else class=\"image\" src=\"@/static/images/default_avatar.png\" mode=\"aspectFill\" />\r\n          <up-text type=\"info\" text=\"点击上传头像\"></up-text>\r\n        </view>\r\n      </view>\r\n      <view class=\"form-content\">\r\n        <view class=\"form-item\">\r\n          <span style=\"color: red\">*</span><text class=\"label\">手机号</text>\r\n          <input class=\"input\" type=\"text\" placeholder=\"请填写手机号\" v-model=\"userInfo.phone\" />\r\n        </view>\r\n        <view class=\"form-item\">\r\n          <span style=\"color: red\">*</span><text class=\"label\">姓名</text>\r\n          <input class=\"input\" type=\"text\" placeholder=\"请填写姓名\" v-model=\"userInfo.nickName\" />\r\n        </view>\r\n        <view class=\"form-item\">\r\n          <span style=\"color: red\">*</span><text class=\"label\">性别</text>\r\n          <radio-group @change=\"onSexChange\">\r\n            <label class=\"radio\">\r\n              <radio value=\"1\" color=\"#27ba9b\" :checked=\"userInfo.sex === 1\" />\r\n              男\r\n            </label>\r\n            <label class=\"radio\">\r\n              <radio value=\"2\" color=\"#27ba9b\" :checked=\"userInfo.sex === 2\" />\r\n              女\r\n            </label>\r\n          </radio-group>\r\n        </view>\r\n        <view class=\"form-item\">\r\n          <span style=\"color: red\">*</span><text class=\"label\">密码</text>\r\n          <input\r\n            class=\"input\"\r\n            type=\"password\"\r\n            placeholder=\"请填写密码\"\r\n            v-model=\"userInfo.password\"\r\n          />\r\n        </view>\r\n      </view>\r\n      <!-- 提交按钮 -->\r\n      <button @tap=\"onSubmit\" class=\"form-button\">注 册</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\npage {\r\n  background-color: #f4f4f4;\r\n}\r\n\r\n.viewport {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  background-color: #ffbf6b;\r\n  background-size: auto 420rpx;\r\n  background-repeat: no-repeat;\r\n}\r\n\r\n// 导航栏\r\n.navbar {\r\n  position: relative;\r\n  background-color: #f4f4f4;\r\n  height: 44px;\r\n\r\n  .title {\r\n    height: 44px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-size: 16px;\r\n    font-weight: 500;\r\n    color: #333;\r\n  }\r\n\r\n  .back {\r\n    position: absolute;\r\n    height: 44px;\r\n    width: 44px;\r\n    left: 10px;\r\n    font-size: 24px;\r\n    color: #28bb9c;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    z-index: 10;\r\n\r\n    &::before {\r\n      content: '';\r\n      position: absolute;\r\n      width: 8px;\r\n      height: 14px;\r\n      border-left: 2px solid #28bb9c;\r\n      border-top: 2px solid #28bb9c;\r\n      transform: rotate(-45deg);\r\n      left: 10px;\r\n    }\r\n  }\r\n}\r\n\r\n// 头像\r\n.avatar {\r\n  text-align: center;\r\n  width: 100%;\r\n  height: 260rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .image {\r\n    width: 160rpx;\r\n    height: 160rpx;\r\n    border-radius: 50%;\r\n    background-color: #eee;\r\n  }\r\n\r\n  .text {\r\n    display: block;\r\n    padding-top: 20rpx;\r\n    line-height: 1;\r\n    font-size: 26rpx;\r\n    color: #fff;\r\n  }\r\n}\r\n\r\n// 表单\r\n.form {\r\n  background-color: #f4f4f4;\r\n\r\n  &-content {\r\n    margin: 20rpx 20rpx 0;\r\n    padding: 0 20rpx;\r\n    border-radius: 10rpx;\r\n    background-color: #fff;\r\n  }\r\n\r\n  &-item {\r\n    display: flex;\r\n    height: 96rpx;\r\n    line-height: 46rpx;\r\n    padding: 25rpx 10rpx;\r\n    background-color: #fff;\r\n    font-size: 28rpx;\r\n    border-bottom: 1rpx solid #ddd;\r\n\r\n    &:last-child {\r\n      border: none;\r\n    }\r\n\r\n    .label {\r\n      width: 180rpx;\r\n      color: #333;\r\n    }\r\n\r\n    .account {\r\n      color: #666;\r\n    }\r\n\r\n    .input {\r\n      flex: 1;\r\n      display: block;\r\n      height: 46rpx;\r\n    }\r\n\r\n    .radio {\r\n      margin-right: 20rpx;\r\n    }\r\n\r\n    .picker {\r\n      flex: 1;\r\n    }\r\n\r\n    .placeholder {\r\n      color: #808080;\r\n    }\r\n  }\r\n\r\n  &-button {\r\n    height: 80rpx;\r\n    text-align: center;\r\n    line-height: 80rpx;\r\n    margin: 30rpx 20rpx;\r\n    color: #fff;\r\n    border-radius: 80rpx;\r\n    font-size: 30rpx;\r\n    background-color: #27ba9b;\r\n  }\r\n}\r\n</style>","import MiniProgramPage from 'D:/gp/2026016-重庆旅游微信小程序的设计与实现/trip-hub-mp/src/pages/register/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","useMemberStore","reactive","onLoad","res","postMemberProfileAPI"],"mappings":";;;;;;;;;;;;;;AAQA,UAAM,EAAE,eAAA,IAAmBA,cAAA,MAAI,kBAAkB;AAE7BC,yCAAe;AAEnC,UAAM,WAAWC,cAAAA,SAAS;AAAA,MACxB,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,MACV,KAAK;AAAA,MACL,QAAQ;AAAA,IAAA,CACT;AAQDC,kBAAAA,OAAO,MAAM;AAAA,IAAA,CAEZ;AAGD,UAAM,iBAAiB,MAAM;AAE3BH,oBAAAA,MAAI,YAAY;AAAA;AAAA,QAEd,OAAO;AAAA;AAAA,QAEP,WAAW,CAAC,OAAO;AAAA,QACnB,SAAS,CAAC,QAAQ;AAEhB,gBAAM,EAAE,aAAiB,IAAA,IAAI,UAAU,CAAC;AAExCA,wBAAAA,MAAI,WAAW;AAAA,YACb,KAAK;AAAA,YACL,MAAM;AAAA,YACN,UAAU;AAAA,YACV,SAAS,CAACI,SAAQ;AACZA,kBAAAA,KAAI,eAAe,KAAK;AAC1B,sBAAM,kBAAkB,KAAK,MAAMA,KAAI,IAAI,EAAE;AAC7C,yBAAS,SAAS;AAClBJ,8BAAA,MAAI,UAAU,EAAE,MAAM,WAAW,OAAO,QAAQ;AAAA,cAAA,OAC3C;AACLA,8BAAA,MAAI,UAAU,EAAE,MAAM,SAAS,OAAO,QAAQ;AAAA,cAChD;AAAA,YACF;AAAA,UAAA,CACD;AAAA,QACH;AAAA,MAAA,CACD;AAAA,IAAA;AAIH,UAAM,WAAW,YAAY;AACvB,UAAA,CAAC,SAAS,OAAO;AACnBA,sBAAA,MAAI,UAAU,EAAE,MAAM,SAAS,OAAO,UAAU;AAChD;AAAA,MACF;AACI,UAAA,SAAS,MAAM,UAAU,MAAM,CAAC,2BAA2B,KAAK,SAAS,KAAK,GAAG;AACnFA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AACD;AAAA,MACF;AACI,UAAA,CAAC,SAAS,UAAU;AACtBA,sBAAA,MAAI,UAAU,EAAE,MAAM,SAAS,OAAO,SAAS;AAC/C;AAAA,MACF;AACI,UAAA,CAAC,SAAS,UAAU;AACtBA,sBAAA,MAAI,UAAU,EAAE,MAAM,SAAS,OAAO,SAAS;AAC/C;AAAA,MACF;AACI,UAAA,CAAC,SAAS,KAAK;AACjBA,sBAAA,MAAI,UAAU,EAAE,MAAM,SAAS,OAAO,SAAS;AAC/C;AAAA,MACF;AACY,YAAMK,iBAAAA,qBAAqB,QAAQ;AAC/CL,oBAAA,MAAI,UAAU,EAAE,MAAM,WAAW,OAAO,QAAQ;AAEhD,iBAAW,MAAM;AACfA,sBAAAA,MAAI,WAAW,EAAE,KAAK,qBAAsB,CAAA;AAAA,SAC3C,GAAG;AAAA,IAAA;AAIF,UAAA,cAA4C,CAAC,OAAO;AACxD,eAAS,MAAM,OAAO,GAAG,OAAO,KAAK;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/FvC,GAAG,WAAW,eAAe;"}
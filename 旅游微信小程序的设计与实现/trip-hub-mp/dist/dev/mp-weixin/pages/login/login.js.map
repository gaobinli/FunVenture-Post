{"version":3,"file":"login.js","sources":["../../../../../src/pages/login/login.vue","../../../../../uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { postNormalLoginAPI, postQuickLoginAPI } from '@/services/login'\r\nimport { useMemberStore } from '@/stores'\r\nimport type { LoginResult } from '@/types/member'\r\nimport { ref, reactive } from 'vue'\r\n\r\n// 获取用户手机号码\r\nconst onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) => {\r\n  await checkedAgreePrivacy()\r\n  const res = await postQuickLoginAPI('15502227374')\r\n  const loginResultReactive = reactive({\r\n    token: res.data,\r\n  })\r\n  loginSuccess(loginResultReactive)\r\n}\r\n\r\nconst form = ref({\r\n  username: '13594677777',\r\n  password: '123456',\r\n})\r\n\r\nconst onSubmit = async () => {\r\n  await checkedAgreePrivacy()\r\n  const res = await postNormalLoginAPI(form.value)\r\n  const loginResultReactive = reactive({\r\n    token: res.data,\r\n  })\r\n  loginSuccess(loginResultReactive)\r\n}\r\n\r\nconst isAgreePrivacy = ref(true)\r\nconst isAgreePrivacyShakeY = ref(false)\r\nconst checkedAgreePrivacy = async () => {\r\n  if (!isAgreePrivacy.value) {\r\n    uni.showToast({\r\n      icon: 'none',\r\n      title: '请先阅读并勾选协议',\r\n    })\r\n    // 震动提示\r\n    isAgreePrivacyShakeY.value = true\r\n    setTimeout(() => {\r\n      isAgreePrivacyShakeY.value = false\r\n    }, 500)\r\n    // 返回错误\r\n    return Promise.reject(new Error('请先阅读并勾选协议'))\r\n  }\r\n}\r\n\r\nconst loginSuccess = (profile: LoginResult) => {\r\n  // 保存信息\r\n  const memberStore = useMemberStore()\r\n  memberStore.setProfile(profile)\r\n  // 成功提示\r\n  uni.showToast({ icon: 'success', title: '登录成功' })\r\n  setTimeout(() => {\r\n    // 页面跳转\r\n    // uni.navigateBack()\r\n    uni.switchTab({ url: '/pages/my/my' })\r\n  }, 1000)\r\n}\r\n</script>\r\n\r\n<template>\r\n  <view class=\"viewport\">\r\n    <view class=\"logo\">\r\n      <view class=\"title\">重庆旅游</view>\r\n      <view class=\"subtitle\">欢迎来到魅力重庆</view>\r\n    </view>\r\n    <view class=\"login\">\r\n      <!-- 小程序账号密码登录 -->\r\n      <view class=\"button-privacy-wrap\">\r\n        <input\r\n          v-model=\"form.username\"\r\n          class=\"input\"\r\n          type=\"text\"\r\n          placeholder=\"请输入用户名/手机号码\"\r\n        />\r\n        <input\r\n          v-model=\"form.password\"\r\n          class=\"input\"\r\n          type=\"text\"\r\n          password\r\n          placeholder=\"请输入密码\"\r\n        />\r\n        <button @tap=\"onSubmit\" class=\"button phone\">登录</button>\r\n        <navigator :url=\"`/pages/register/register`\" hover-class=\"none\" class=\"navigator\">\r\n          <button class=\"register\">注册</button>\r\n        </navigator>\r\n      </view>\r\n      <!-- <view class=\"extra\">\r\n        <view class=\"caption\">\r\n          <text>其他登录方式</text>\r\n        </view>\r\n        <view class=\"options\">\r\n          \r\n          <button @getphonenumber=\"onGetphonenumber\" open-type=\"getPhoneNumber\">\r\n            <text class=\"icon icon-phone\">模拟快捷登录</text>\r\n          </button>\r\n        </view>\r\n      </view> -->\r\n      <view class=\"tips\" :class=\"{ animate__shakeY: isAgreePrivacyShakeY }\">\r\n        <label class=\"label\" @tap=\"isAgreePrivacy = !isAgreePrivacy\">\r\n          <radio class=\"radio\" color=\"#28bb9c\" :checked=\"isAgreePrivacy\" />\r\n          <text>登录/注册即视为你同意重庆旅游平台</text>\r\n        </label>\r\n        <navigator class=\"link\" hover-class=\"none\" url=\"./protocal\">《服务条款》</navigator>\r\n        和\r\n        <text class=\"link\" @tap=\"onOpenPrivacyContract\">《隐私协议》</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\npage {\r\n  height: 100%;\r\n}\r\n\r\n.viewport {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding: 20rpx 40rpx;\r\n}\r\n\r\n.logo {\r\n  flex: 1;\r\n  text-align: center;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .title {\r\n    font-size: 56rpx;\r\n    font-weight: bold;\r\n    color: #28bb9c;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .subtitle {\r\n    font-size: 32rpx;\r\n    color: #333;\r\n    margin-bottom: 30rpx;\r\n    font-weight: 500;\r\n  }\r\n\r\n  .description {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 12rpx;\r\n    margin-bottom: 40rpx;\r\n\r\n    text {\r\n      font-size: 26rpx;\r\n      color: #666;\r\n      line-height: 1.6;\r\n    }\r\n  }\r\n\r\n  .features {\r\n    display: flex;\r\n    justify-content: center;\r\n    gap: 40rpx;\r\n    margin-top: 20rpx;\r\n\r\n    .feature-item {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      gap: 8rpx;\r\n\r\n      .feature-icon {\r\n        font-size: 48rpx;\r\n      }\r\n\r\n      .feature-text {\r\n        font-size: 24rpx;\r\n        color: #666;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.register {\r\n  margin-top: 12px;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 100%;\r\n  // height: 80rpx;\r\n  line-height: 80rpx;\r\n  font-size: 28rpx;\r\n  border-radius: 72rpx;\r\n  color: #000000;\r\n}\r\n\r\n.login {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 60vh;\r\n  padding: 40rpx 20rpx 20rpx;\r\n\r\n  .input {\r\n    width: 100%;\r\n    height: 80rpx;\r\n    font-size: 28rpx;\r\n    border-radius: 72rpx;\r\n    border: 1px solid #ddd;\r\n    padding-left: 30rpx;\r\n    margin-bottom: 20rpx;\r\n  }\r\n\r\n  .button {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 100%;\r\n    height: 80rpx;\r\n    font-size: 28rpx;\r\n    border-radius: 72rpx;\r\n    color: #fff;\r\n\r\n    .icon {\r\n      font-size: 40rpx;\r\n      margin-right: 6rpx;\r\n    }\r\n  }\r\n\r\n  .phone {\r\n    background-color: #28bb9c;\r\n  }\r\n\r\n  .wechat {\r\n    background-color: #06c05f;\r\n  }\r\n\r\n  .extra {\r\n    flex: 1;\r\n    padding: 70rpx 70rpx 0;\r\n\r\n    .caption {\r\n      width: 440rpx;\r\n      line-height: 1;\r\n      border-top: 1rpx solid #ddd;\r\n      font-size: 26rpx;\r\n      color: #999;\r\n      position: relative;\r\n\r\n      text {\r\n        transform: translate(-40%);\r\n        background-color: #fff;\r\n        position: absolute;\r\n        top: -12rpx;\r\n        left: 50%;\r\n      }\r\n    }\r\n\r\n    .options {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      margin-top: 70rpx;\r\n\r\n      button {\r\n        padding: 0;\r\n        background-color: transparent;\r\n\r\n        &::after {\r\n          border: none;\r\n        }\r\n      }\r\n    }\r\n\r\n    .icon {\r\n      font-size: 24rpx;\r\n      color: #444;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n\r\n      &::before {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        width: 80rpx;\r\n        height: 80rpx;\r\n        margin-bottom: 6rpx;\r\n        font-size: 40rpx;\r\n        border: 1rpx solid #444;\r\n        border-radius: 50%;\r\n      }\r\n    }\r\n\r\n    .icon-weixin::before {\r\n      border-color: #06c05f;\r\n      color: #06c05f;\r\n    }\r\n  }\r\n}\r\n\r\n@keyframes animate__shakeY {\r\n  0% {\r\n    transform: translate(0, 0);\r\n  }\r\n\r\n  50% {\r\n    transform: translate(0, -5rpx);\r\n  }\r\n\r\n  100% {\r\n    transform: translate(0, 0);\r\n  }\r\n}\r\n\r\n.animate__shakeY {\r\n  animation: animate__shakeY 0.2s ease-in-out 3;\r\n}\r\n\r\n.button-privacy-wrap {\r\n  position: relative;\r\n\r\n  .button-opacity {\r\n    opacity: 0;\r\n    position: absolute;\r\n    z-index: 1;\r\n  }\r\n}\r\n\r\n.tips {\r\n  position: absolute;\r\n  bottom: 80rpx;\r\n  left: 20rpx;\r\n  right: 20rpx;\r\n  font-size: 22rpx;\r\n  color: #999;\r\n  text-align: center;\r\n\r\n  .radio {\r\n    transform: scale(0.6);\r\n    margin-right: -4rpx;\r\n    margin-top: -4rpx;\r\n    vertical-align: middle;\r\n  }\r\n\r\n  .link {\r\n    display: inline;\r\n    color: #28bb9c;\r\n  }\r\n}\r\n</style>","import MiniProgramPage from 'D:/gp/2026016-重庆旅游微信小程序的设计与实现/trip-hub-mp/src/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","postNormalLoginAPI","reactive","uni","useMemberStore"],"mappings":";;;;;;;;;AAgBA,UAAM,OAAOA,cAAAA,IAAI;AAAA,MACf,UAAU;AAAA,MACV,UAAU;AAAA,IAAA,CACX;AAED,UAAM,WAAW,YAAY;AAC3B,YAAM,oBAAoB;AAC1B,YAAM,MAAM,MAAMC,eAAAA,mBAAmB,KAAK,KAAK;AAC/C,YAAM,sBAAsBC,cAAAA,SAAS;AAAA,QACnC,OAAO,IAAI;AAAA,MAAA,CACZ;AACD,mBAAa,mBAAmB;AAAA,IAAA;AAG5B,UAAA,iBAAiBF,kBAAI,IAAI;AACzB,UAAA,uBAAuBA,kBAAI,KAAK;AACtC,UAAM,sBAAsB,YAAY;AAClC,UAAA,CAAC,eAAe,OAAO;AACzBG,sBAAAA,MAAI,UAAU;AAAA,UACZ,MAAM;AAAA,UACN,OAAO;AAAA,QAAA,CACR;AAED,6BAAqB,QAAQ;AAC7B,mBAAW,MAAM;AACf,+BAAqB,QAAQ;AAAA,WAC5B,GAAG;AAEN,eAAO,QAAQ,OAAO,IAAI,MAAM,WAAW,CAAC;AAAA,MAC9C;AAAA,IAAA;AAGI,UAAA,eAAe,CAAC,YAAyB;AAE7C,YAAM,cAAcC,sBAAAA;AACpB,kBAAY,WAAW,OAAO;AAE9BD,oBAAA,MAAI,UAAU,EAAE,MAAM,WAAW,OAAO,QAAQ;AAChD,iBAAW,MAAM;AAGfA,sBAAAA,MAAI,UAAU,EAAE,KAAK,eAAgB,CAAA;AAAA,SACpC,GAAI;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;ACzDT,GAAG,WAAW,eAAe;"}
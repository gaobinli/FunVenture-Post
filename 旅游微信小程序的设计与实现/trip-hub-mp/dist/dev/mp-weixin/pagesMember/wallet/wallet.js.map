{"version":3,"file":"wallet.js","sources":["../../../../../src/pagesMember/wallet/wallet.vue","../../../../../uniPage:/cGFnZXNNZW1iZXJcd2FsbGV0XHdhbGxldC52dWU"],"sourcesContent":["<script setup lang=\"ts\">\nimport { useMemberStore } from '@/stores'\nimport { getMemberProfileAPI } from '@/services/profile'\nimport { patchUserBalanceAPI } from '@/services/profile'\nimport { ref, reactive } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\n\n// Ëé∑ÂèñÂ±èÂπïËæπÁïåÂà∞ÂÆâÂÖ®Âå∫ÂüüË∑ùÁ¶ª\nconst { safeAreaInsets } = uni.getSystemInfoSync()\n\nconst memberStore = useMemberStore()\nconst userInfo = ref<any>(null)\n\n// Èí±ÂåÖÊï∞ÊçÆ\nconst walletData = reactive({\n  currentBalance: 0,\n  rechargeAmount: '',\n  paymentMethod: 'wechat', // 'wechat', 'alipay', 'bank'\n  showRechargeForm: false,\n})\n\n// ÊîØ‰ªòÊñπÂºèÂàóË°®\nconst paymentMethods = [\n  { value: 'wechat', label: 'ÂæÆ‰ø°ÊîØ‰ªò', icon: 'üí¨' },\n  { value: 'alipay', label: 'ÊîØ‰ªòÂÆù', icon: 'üîµ' },\n  { value: 'bank', label: 'Èì∂Ë°åÂç°', icon: 'üè¶' },\n]\n\n// Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ\nonShow(async () => {\n  if (memberStore.profile) {\n    const res = await getMemberProfileAPI()\n    userInfo.value = res.data\n    walletData.currentBalance = userInfo.value.balance || 0\n  }\n})\n\n// ÊòæÁ§∫/ÈöêËóèÂÖÖÂÄºË°®Âçï\nconst toggleRechargeForm = () => {\n  walletData.showRechargeForm = !walletData.showRechargeForm\n  if (!walletData.showRechargeForm) {\n    walletData.rechargeAmount = ''\n  }\n}\n\n// È™åËØÅÂÖÖÂÄºÈáëÈ¢ù\nconst validateRechargeAmount = () => {\n  if (!walletData.rechargeAmount) {\n    uni.showToast({\n      icon: 'error',\n      title: 'ËØ∑ËæìÂÖ•ÂÖÖÂÄºÈáëÈ¢ù',\n    })\n    return false\n  }\n\n  const amount = parseFloat(walletData.rechargeAmount)\n  if (isNaN(amount) || amount <= 0) {\n    uni.showToast({\n      icon: 'error',\n      title: 'ÂÖÖÂÄºÈáëÈ¢ùÂøÖÈ°ªÂ§ß‰∫é0',\n    })\n    return false\n  }\n\n  if (amount > 100000) {\n    uni.showToast({\n      icon: 'error',\n      title: 'ÂÖÖÂÄºÈáëÈ¢ù‰∏çËÉΩË∂ÖËøá100000',\n    })\n    return false\n  }\n\n  return true\n}\n\n// Â§ÑÁêÜÂÖÖÂÄº\nconst handleRecharge = async () => {\n  if (!validateRechargeAmount()) {\n    return\n  }\n\n  const rechargeAmount = parseFloat(walletData.rechargeAmount)\n  const methodLabel = paymentMethods.find(m => m.value === walletData.paymentMethod)?.label || 'ÂæÆ‰ø°ÊîØ‰ªò'\n\n  // ÊòæÁ§∫Â§ÑÁêÜ‰∏≠\n  uni.showLoading({\n    title: 'Â§ÑÁêÜ‰∏≠...',\n    mask: true,\n  })\n\n  try {\n    // Ê®°ÊãüÊîØ‰ªòËøáÁ®ãÔºàÂÆûÈôÖÂ∫îËØ•Ë∞ÉÁî®ÊîØ‰ªòÊé•Âè£Ôºâ\n    setTimeout(async () => {\n      try {\n        // ËÆ°ÁÆóÊñ∞‰ΩôÈ¢ù\n        const newBalance = walletData.currentBalance + rechargeAmount\n\n        // Ë∞ÉÁî®APIÊõ¥Êñ∞‰ΩôÈ¢ù\n        const updateRes = await patchUserBalanceAPI(userInfo.value.id, newBalance)\n\n        // Êõ¥Êñ∞Êú¨Âú∞Áä∂ÊÄÅ\n        walletData.currentBalance = newBalance\n        walletData.rechargeAmount = ''\n        walletData.showRechargeForm = false\n\n        uni.hideLoading()\n        uni.showToast({\n          icon: 'success',\n          title: `ÂÖÖÂÄºÊàêÂäü +¬•${rechargeAmount.toFixed(2)}`,\n        })\n\n        // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØÁºìÂ≠ò\n        userInfo.value.balance = newBalance\n      } catch (error) {\n        uni.hideLoading()\n        uni.showToast({\n          icon: 'error',\n          title: 'ÂÖÖÂÄºÂ§±Ë¥•ÔºåËØ∑ÈáçËØï',\n        })\n        console.error('ÂÖÖÂÄºÂ§±Ë¥•:', error)\n      }\n    }, 1500)\n  } catch (error) {\n    uni.hideLoading()\n    uni.showToast({\n      icon: 'error',\n      title: 'Â§ÑÁêÜÂ§±Ë¥•',\n    })\n    console.error('ÈîôËØØ:', error)\n  }\n}\n\n// ÈÄâÊã©ÊîØ‰ªòÊñπÂºè\nconst selectPaymentMethod = (method: string) => {\n  walletData.paymentMethod = method\n}\n\n// ÂèñÊ∂àÂÖÖÂÄº\nconst cancelRecharge = () => {\n  walletData.rechargeAmount = ''\n  walletData.showRechargeForm = false\n}\n</script>\n\n<template>\n  <view class=\"viewport\" :style=\"{ paddingTop: safeAreaInsets!.top + 'px' }\">\n    <!-- ÂØºËà™Ê†è -->\n    <view class=\"navbar\">\n      <navigator open-type=\"navigateBack\" class=\"back\" hover-class=\"none\">\n        <view class=\"back-icon\">‚Äπ</view>\n      </navigator>\n      <view class=\"title\">ÊàëÁöÑÈí±ÂåÖ</view>\n      <view class=\"placeholder\"></view>\n    </view>\n\n    <!-- ‰ΩôÈ¢ùÂ±ïÁ§∫ -->\n    <view class=\"balance-card\">\n      <view class=\"balance-title\">ÂΩìÂâç‰ΩôÈ¢ù</view>\n      <view class=\"balance-amount\">¬•{{ walletData.currentBalance.toFixed(2) }}</view>\n      <view class=\"balance-description\">ÂèØÁî®‰∫éËÆ¢ÂçïÊîØ‰ªò</view>\n    </view>\n\n    <!-- ÂÖÖÂÄºÊåâÈíÆ -->\n    <view class=\"recharge-button-wrapper\">\n      <button\n        v-if=\"!walletData.showRechargeForm\"\n        @tap=\"toggleRechargeForm\"\n        class=\"recharge-button\"\n      >\n        + Á´ãÂç≥ÂÖÖÂÄº\n      </button>\n    </view>\n\n    <!-- ÂÖÖÂÄºË°®Âçï -->\n    <view v-if=\"walletData.showRechargeForm\" class=\"recharge-form\">\n      <view class=\"form-title\">ÂÖÖÂÄºÈáëÈ¢ù</view>\n\n      <!-- ÈáëÈ¢ùËæìÂÖ• -->\n      <view class=\"amount-input-wrapper\">\n        <view class=\"currency-symbol\">¬•</view>\n        <input\n          v-model=\"walletData.rechargeAmount\"\n          class=\"amount-input\"\n          type=\"number\"\n          placeholder=\"ËØ∑ËæìÂÖ•ÂÖÖÂÄºÈáëÈ¢ù\"\n          placeholder-class=\"placeholder\"\n        />\n      </view>\n\n      <!-- Âø´ÈÄüÂÖÖÂÄºÈáëÈ¢ù -->\n      <view class=\"quick-amount\">\n        <view class=\"quick-title\">Âø´ÈÄüÂÖÖÂÄº</view>\n        <view class=\"quick-buttons\">\n          <button\n            v-for=\"amount in [50, 100, 500]\"\n            :key=\"amount\"\n            @tap=\"walletData.rechargeAmount = amount.toString()\"\n            class=\"quick-btn\"\n          >\n            ¬•{{ amount }}\n          </button>\n        </view>\n      </view>\n\n      <!-- ÊîØ‰ªòÊñπÂºèÈÄâÊã© -->\n      <view class=\"payment-method\">\n        <view class=\"method-title\">ÈÄâÊã©ÊîØ‰ªòÊñπÂºè</view>\n        <view class=\"method-list\">\n          <view\n            v-for=\"method in paymentMethods\"\n            :key=\"method.value\"\n            @tap=\"selectPaymentMethod(method.value)\"\n            class=\"method-item\"\n            :class=\"{ active: walletData.paymentMethod === method.value }\"\n          >\n            <view class=\"method-icon\">{{ method.icon }}</view>\n            <view class=\"method-label\">{{ method.label }}</view>\n            <view v-if=\"walletData.paymentMethod === method.value\" class=\"method-check\">‚úì</view>\n          </view>\n        </view>\n      </view>\n\n      <!-- Êìç‰ΩúÊåâÈíÆ -->\n      <view class=\"form-buttons\">\n        <button @tap=\"cancelRecharge\" class=\"button cancel\">ÂèñÊ∂à</button>\n        <button @tap=\"handleRecharge\" class=\"button confirm\">Á°ÆËÆ§ÂÖÖÂÄº</button>\n      </view>\n    </view>\n\n    <!-- ‰∫§ÊòìËÆ∞ÂΩïÊèêÁ§∫ -->\n    <view v-if=\"!walletData.showRechargeForm\" class=\"transaction-notice\">\n      <view class=\"notice-title\">ÂÖÖÂÄºËØ¥Êòé</view>\n      <view class=\"notice-content\">\n        <view class=\"notice-item\">‚úì ÂÖÖÂÄºÈáëÈ¢ùÂÆûÊó∂Âà∞Ë¥¶</view>\n        <view class=\"notice-item\">‚úì ÊîØÊåÅÂæÆ‰ø°„ÄÅÊîØ‰ªòÂÆù„ÄÅÈì∂Ë°åÂç°ÊîØ‰ªò</view>\n        <view class=\"notice-item\">‚úì ÂÖÖÂÄºÂêéÂèØÁî®‰∫éÊâÄÊúâËÆ¢ÂçïÊîØ‰ªò</view>\n        <view class=\"notice-item\">‚úì ‰ΩôÈ¢ù‰∏çÊîØÊåÅÊèêÁé∞</view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\npage {\n  background-color: #f7f7f8;\n  height: 100%;\n}\n\n.viewport {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background-color: #f7f7f8;\n}\n\n/* ÂØºËà™Ê†è */\n.navbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 44px;\n  padding: 0 16px;\n  background-color: #fff;\n  border-bottom: 1rpx solid #eee;\n\n  .back {\n    width: 44px;\n    height: 44px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: #28bb9c;\n\n    .back-icon {\n      font-size: 32px;\n      font-weight: bold;\n    }\n  }\n\n  .title {\n    flex: 1;\n    text-align: center;\n    font-size: 16px;\n    font-weight: 500;\n    color: #333;\n  }\n\n  .placeholder {\n    width: 44px;\n  }\n}\n\n/* ‰ΩôÈ¢ùÂç°Áâá */\n.balance-card {\n  margin: 30rpx 20rpx;\n  padding: 40rpx 30rpx;\n  background: linear-gradient(135deg, #28bb9c 0%, #1e9b7c 100%);\n  border-radius: 10rpx;\n  color: #fff;\n  text-align: center;\n  box-shadow: 0 4rpx 15rpx rgba(40, 187, 156, 0.3);\n\n  .balance-title {\n    font-size: 24rpx;\n    opacity: 0.9;\n    margin-bottom: 16rpx;\n  }\n\n  .balance-amount {\n    font-size: 64rpx;\n    font-weight: bold;\n    margin-bottom: 12rpx;\n    letter-spacing: 2rpx;\n  }\n\n  .balance-description {\n    font-size: 20rpx;\n    opacity: 0.8;\n  }\n}\n\n/* ÂÖÖÂÄºÊåâÈíÆ */\n.recharge-button-wrapper {\n  padding: 0 20rpx 30rpx;\n\n  .recharge-button {\n    width: 100%;\n    height: 80rpx;\n    line-height: 80rpx;\n    text-align: center;\n    background-color: #28bb9c;\n    color: #fff;\n    font-size: 30rpx;\n    border-radius: 8rpx;\n    border: none;\n  }\n}\n\n/* ÂÖÖÂÄºË°®Âçï */\n.recharge-form {\n  background-color: #fff;\n  margin: 20rpx;\n  padding: 30rpx;\n  border-radius: 10rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n\n  .form-title {\n    font-size: 28rpx;\n    font-weight: 500;\n    color: #333;\n    margin-bottom: 20rpx;\n  }\n\n  /* ÈáëÈ¢ùËæìÂÖ• */\n  .amount-input-wrapper {\n    display: flex;\n    align-items: center;\n    height: 80rpx;\n    background-color: #f5f5f5;\n    border-radius: 8rpx;\n    padding: 0 20rpx;\n    margin-bottom: 30rpx;\n    border: 2rpx solid #e5e5e5;\n\n    .currency-symbol {\n      font-size: 32rpx;\n      color: #28bb9c;\n      font-weight: bold;\n      margin-right: 10rpx;\n    }\n\n    .amount-input {\n      flex: 1;\n      height: 80rpx;\n      font-size: 32rpx;\n      background-color: transparent;\n      border: none;\n\n      .placeholder {\n        color: #999;\n      }\n    }\n  }\n\n  /* Âø´ÈÄüÂÖÖÂÄº */\n  .quick-amount {\n    margin-bottom: 30rpx;\n\n    .quick-title {\n      font-size: 24rpx;\n      color: #666;\n      margin-bottom: 12rpx;\n    }\n\n    .quick-buttons {\n      display: flex;\n      gap: 12rpx;\n\n      .quick-btn {\n        flex: 1;\n        height: 60rpx;\n        line-height: 60rpx;\n        text-align: center;\n        background-color: #f5f5f5;\n        color: #28bb9c;\n        font-size: 24rpx;\n        border: 2rpx solid #ddd;\n        border-radius: 6rpx;\n\n        &:active {\n          background-color: #e8f5f1;\n          border-color: #28bb9c;\n        }\n      }\n    }\n  }\n\n  /* ÊîØ‰ªòÊñπÂºè */\n  .payment-method {\n    margin-bottom: 30rpx;\n\n    .method-title {\n      font-size: 24rpx;\n      color: #666;\n      margin-bottom: 16rpx;\n    }\n\n    .method-list {\n      display: flex;\n      gap: 16rpx;\n\n      .method-item {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        padding: 20rpx;\n        background-color: #f5f5f5;\n        border: 2rpx solid #ddd;\n        border-radius: 8rpx;\n        position: relative;\n\n        &.active {\n          background-color: #e8f5f1;\n          border-color: #28bb9c;\n\n          .method-label {\n            color: #28bb9c;\n          }\n        }\n\n        .method-icon {\n          font-size: 40rpx;\n          margin-bottom: 8rpx;\n        }\n\n        .method-label {\n          font-size: 20rpx;\n          color: #666;\n        }\n\n        .method-check {\n          position: absolute;\n          top: 8rpx;\n          right: 8rpx;\n          width: 28rpx;\n          height: 28rpx;\n          background-color: #28bb9c;\n          color: #fff;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 16rpx;\n          font-weight: bold;\n        }\n      }\n    }\n  }\n\n  /* Êìç‰ΩúÊåâÈíÆ */\n  .form-buttons {\n    display: flex;\n    gap: 16rpx;\n    margin-top: 30rpx;\n\n    .button {\n      flex: 1;\n      height: 80rpx;\n      line-height: 80rpx;\n      text-align: center;\n      font-size: 28rpx;\n      border-radius: 8rpx;\n      border: none;\n\n      &.cancel {\n        background-color: #f5f5f5;\n        color: #666;\n      }\n\n      &.confirm {\n        background-color: #28bb9c;\n        color: #fff;\n      }\n    }\n  }\n}\n\n/* ÂÖÖÂÄºËØ¥Êòé */\n.transaction-notice {\n  margin: 20rpx;\n  padding: 20rpx;\n  background-color: #fff;\n  border-radius: 10rpx;\n\n  .notice-title {\n    font-size: 28rpx;\n    font-weight: 500;\n    color: #333;\n    margin-bottom: 16rpx;\n  }\n\n  .notice-content {\n    .notice-item {\n      font-size: 24rpx;\n      color: #666;\n      line-height: 40rpx;\n      padding-left: 10rpx;\n    }\n  }\n}\n</style>\n","import MiniProgramPage from 'D:/gp/2026016-ÈáçÂ∫ÜÊóÖÊ∏∏ÂæÆ‰ø°Â∞èÁ®ãÂ∫èÁöÑËÆæËÆ°‰∏éÂÆûÁé∞/trip-hub-mp/src/pagesMember/wallet/wallet.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","useMemberStore","ref","reactive","onShow","getMemberProfileAPI","patchUserBalanceAPI"],"mappings":"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"}